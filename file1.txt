Some code from John
Amy's changes
Another change from Amy
